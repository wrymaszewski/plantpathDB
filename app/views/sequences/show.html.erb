<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @sequence.name %>
</p>

<% if @sequence.sequence_attachments.first %>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Comment</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @sequence.sequence_attachments.each do |sequence_attachment| %>
        <tr>
          <td><%= sequence_attachment.sequence_type %></td>
          <td><%= sequence_attachment.comment %></td>
          <td><%= link_to "View file", :controller => 'sequence_attachments',
          :action => 'view_file', :id =>sequence_attachment.id, :sequence_id =>sequence_attachment.sequence.id %></td>
          <td><%= link_to "Download file", :controller => 'sequence_attachments',
          :action => 'download_file', :id =>sequence_attachment.id, :sequence_id =>sequence_attachment.sequence.id %></td>

          <% if current_user.username == 'admin' %>
          <td><%= link_to 'Edit', edit_sequence_sequence_attachment_path(@sequence, sequence_attachment)%></td>
          <td><%= link_to 'Destroy', [@sequence, sequence_attachment], method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <%end%>
        </tr>
      <% end %>
    </tbody>
  </table>
  <br>
<%else%>
<p>No sequence files added</p>
<%end%>
<%= link_to 'New Sequence attachment', new_sequence_sequence_attachment_path(@sequence) %>



<%if @sequence.primers.first %>
  <h1>Listing Primers</h1>

  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Primer sequence</th>
        <th>Direction</th>
        <th>Length</th>
        <th>Tm</th>
        <th>5' position</th>
        <th>Comments</th>
        <th colspan="3"></th>
      </tr>
    </thead>
    <tbody>
          <% @sequence.primers.each do |primer| %>
            <tr>
              <td><%= primer.name %></td>
              <td><%= primer.p_sequence %></td>
              <td><%= primer.direction %></td>
              <td><%= primer.length %></td>
              <td><%= primer.Tm.round(1) %></td>
              <td><%= primer.position %></td>
              <td><%= primer.comments %></td>
              <% if current_user.username == 'admin' %>
                <td><%= link_to 'Edit', edit_sequence_primer_path(@sequence, primer) %></td>
                <td><%= link_to 'Destroy', [@sequence, primer], method: :delete, data: { confirm: 'Are you sure?' } %></td>
              <%end%>
              <% form_for @sequence, url: {action: "checked"} , :method => :put do %>
                <td><%= check_box_tag "primer_ids[]", primer.id %></td>
            </tr>
            <%= submit_tag "Choose primer pair" %>
              <% end %>
             <% end %>
    </tbody>
  </table>

  <div>Amplicon size</div>
  <% if @sequence.primers.count>1 %>
  <% @sequence.save %>
  <p><%= @sequence.calculate_product_size %></p>
<% end %>
<%else%>
  <p>No primers added</p>
<%end%>

<br>

<%= link_to 'New Primer', new_sequence_primer_path(@sequence) %><br>
<%= link_to 'All Primers', primers_path %>


<%if @sequence.bacterial_stocks.first %>
  <h1>Bacterial Stocks</h1>

  <table>
    <thead>
      <tr>
        <th>Number</th>
        <th>Insert</th>
        <th>Plasmid</th>
        <th>Tag</th>
        <th>Species</th>
        <th>Strain</th>
        <th>Antibiotic resistance</th>
        <th>Methods of cloning</th>
        <th>Source</th>
        <th>Comments</th>
        <th colspan="3"></th>
      </tr>
    </thead>

    <tbody>
      <% @sequence.bacterial_stocks.each do |bacterial_stock| %>
        <tr>
          <td><%= bacterial_stock.number %></td>
          <td><%= bacterial_stock.insert %></td>
          <td><%= bacterial_stock.plasmid %></td>
          <td><%= bacterial_stock.tag %></td>
          <td><%= bacterial_stock.species %></td>
          <td><%= bacterial_stock.strain %></td>
          <td><%= bacterial_stock.antibiotic_resistance %></td>
          <td><%= bacterial_stock.methods_of_cloning %></td>
          <td><%= bacterial_stock.source %></td>
          <td><%= bacterial_stock.comments %></td>
          <% if current_user.username == 'admin' %>
            <td><%= link_to 'Edit', edit_sequence_bacterial_stock_path(@sequence, bacterial_stock) %></td>
            <td><%= link_to 'Destroy', [@sequence, bacterial_stock], method: :delete, data: { confirm: 'Are you sure?' } %></td>
          <%end%>
        </tr>
      <% end %>
    </tbody>
  </table>
<%else%>
  <p>No bacterial stocks added</p>
<%end%>
  <br>

<%= link_to 'New Bacterial Stock', new_sequence_bacterial_stock_path(@sequence) %><br>
<%= link_to 'All bacterial stocks', bacterial_stocks_path %><br>
<%= link_to 'All sequences', sequences_path %>
